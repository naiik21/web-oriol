---
import Layout from '../layouts/Layout.astro'
---

<Layout title='Contacto | Oriol Ortega'>
  <main>
    <form
      id='contact-form'
      class='mt-20 p-4 border rounded shadow-md max-w-md'
      method='POST'>
      <label for='name'>Nombre:</label>
      <input type='text' id='name' name='name' required />

      <label for=''>Correo:</label>
      <input type='email' id='email' name='email' required />

      <label for='message'>Mensaje:</label>
      <textarea id='' name='message' required></textarea>

      <button type='submit' id='submit'>Enviar</button>
    </form>
  </main>
</Layout>

<script type='text/javascript'>
  document
    .getElementById('contact-form')
    .addEventListener('submit', async (e) => {
      e.preventDefault()

      const name = document.getElementById('name').value
      const email = document.getElementById('email').value
      const message = document.getElementById('message').value

      try {
        const response = await fetch('/api/send-email', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ name, email, message })
        })

        const result = await response.json()
        if (response.ok) {
          alert(result.message) // Mensaje de Ã©xito
        } else {
          alert(result.message) // Mensaje de error
        }
      } catch (error) {
        console.error('Error:', error)
        alert('Error al enviar el correo')
      }
    })
</script>
